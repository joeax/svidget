/* Svidget.js v0.3.5 on 2018-08-13, Copyright 2018 Joe Agster http://www.svidget.org MIT License */

!function(e,t){"function"==typeof define&&define.amd?define(["svidget"],t):"object"==typeof module&&module.exports?module.exports=t:e.svidget=t(e)}(this,function(i,e){var h={},d=i,u=d.document||{};h.root=null,h.global=i,h.version="0.3.5",h.declaredHandlerName="_declared",h.emptyArray=[],h.defaultType="object",h.array=function(t){if(!t||!t.length)return null;try{return h.emptyArray.slice.call(t,0)}catch(e){for(var n=[],r=0;r<t.length;r++)n.push(t[r]);return n}},h.isArray=function(e){return null!=e&&(Array.isArray(e)||Array.prototype.isPrototypeOf(e)||e.length&&e.push)},h.isFunction=function(e){return"function"==typeof e},h.isString=function(e){return"string"==typeof e||e.length&&e.trim&&e.charAt},h.isColor=function(e){return!1},h.convert=function(e,t,n,r){return h.Conversion.to(e,t,n,r)},h.getType=function(e){if(null==e)return h.defaultType;if(h.isArray(e))return"array";var t=typeof e;return"string"===t||"number"===t||"boolean"===t?t:"object"},h.resolveType=function(e){return e=h.Conversion.toString(e),void 0===h.ParamTypes[e]?h.defaultType:"bool"===e?"boolean":e},h.resolveSubtype=function(e,t){return e=h.resolveType(e),void 0===h.ParamSubTypes[t]?null:"string"!=e||"color"!=t&&"regex"!=t&&"color"!=t?"number"==e&&"integer"==t?t:null:t},h.extend=function(e,t,n){for(var r in t)(n||void 0===e.prototype[r])&&(e.prototype[r]=t[r])},h.wrap=function(e,t){if(null!=e&&"function"==typeof e){return function(){return e.apply(t,arguments)}}},h.findFunction=function(e,t){if("function"==typeof e)return e;if(null==t&&(t=d),null!=e){var n=e+"",r=t[n];return null==r&&t!==i&&(r=i[n]),null==r?null:"function"==typeof r?r:"return "!=n.substr(0,7)?new Function("return "+n):new Function(n)}return null},h.log=function(e){h.Settings.enableLogging&&console.log(e)},h.readOnlyProperty=function(e){return{enumerable:!0,configurable:!1,writable:!1,value:e}},h.fixedProperty=function(e){return{enumerable:!0,configurable:!1,writable:!0,value:e}},h.getPrivateAccessor=function(t){return function(e){return t[e]}},h.setPrivateAccessor=function(n){return function(e,t){return!!n.writable.contains(e)&&(n[e]=t,!0)}},h.returnFalse=function(){return!1},h.returnTrue=function(){return!0},h.Settings={},h.Settings.showPrivates=!0,h.Settings.enableLogging=!1,Array.prototype.contains||(Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),h.ObjectPrototype={setup:function(e){this.getPrivate=h.getPrivateAccessor(e),this.setPrivate=h.setPrivateAccessor(e),h.Settings.showPrivates&&(this.privates=e)},getset:function(e,t,n,r){var i=this.getPrivate(e);return void 0===t?i:(null!=n&&(t=h.convert(t,n)),t!==i&&(!(r&&!r.call(this,t))&&this.setPrivate(e,t)))},select:function(e,t){return"number"==typeof t?(t=parseInt(t),e.wrap(e.getByIndex(t))):"function"==typeof t?e.where(t):void 0!==t?e.wrap(e.getByName(t+"")):e},selectFirst:function(e,t){return"number"==typeof t?(t=parseInt(t),e.getByIndex(t)):"function"==typeof t?e.first(t):void 0!==t?e.getByName(t+""):e.first()},wireCollectionAddRemoveHandlers:function(e,t,n){null!=e&&(e.onAdded(h.wrap(t,this)),e.onRemoved(h.wrap(n,this)))}},h.EventPrototype=function(e){this.eventTypes=new h.Collection(e)},h.EventPrototype.prototype={on:function(e,t,n,r){var i=h.isFunction(r)?4:h.isFunction(n)?3:h.isFunction(t)?2:1;return r=4==i?r:3==i?n:2==i?t:null,t=2<i?t:null,n=3<i?n:null,!!r&&this.addHandler(e,r,n,t)},off:function(e,t){var n=h.isFunction(t)?t:null,r=null!=n?null:t;return this.removeHandler(e,n,r)},trigger:function(e,t,n){if(null!=e){var r=this.triggerHandlers(e,t,n);h.log("trigger: "+e),r.isPropagationStopped()||this.bubble(e,r)}},triggerHandlers:function(e,t,n){var r=new h.Event(null,e,null,this.getTarget(),n,t);return null==e||null==this.handlers||null==this.handlers[e]||this.handlers[e].each(function(e){if(r.isImmediatePropagationStopped())return!1;null!=e&&null!=e.handler&&"function"==typeof e.handler&&(r.name=e.name,r.data=e.data,e.handler.call(null,r))}),r},bubble:function(e,t){this.ensureBubbleParents(),t.name=null,t.data=null,this.bubbleParents[e]&&this.bubbleParents[e](e,t,this.getTarget())},addHandler:function(e,t,n,r){if(this.ensureHandlersByType(e),this.handlerExists(e,t,n))return!1;var i=this.toHandlerObject(t,n,r);return this.handlers[e].push(i),!0},removeHandler:function(e,t,n){if(this.ensureHandlers(),!this.handlers[e])return!1;var r=this;return this.handlers[e].removeWhere(function(e){return r.handlerMatch(e,t,n)})},handlerExists:function(e,t,n){var r=this;return this.handlers[e].any(function(e){return r.handlerMatch(e,t,n)})},handlerMatch:function(e,t,n){return null!=n&&e.name===n||t===e.handler},setBubbleParent:function(e,t){this.ensureBubbleParents(),this.bubbleParents[e]=t},registerBubbleCallback:function(e,t,n){if(t&&n)for(var r=0;r<e.length;r++)this.setBubbleParent(e[r],h.wrap(n,t))},toHandlerObject:function(e,t,n){return{handler:e,name:t,data:n}},bubbleFuncs:function(e){},ensureHandlers:function(){this.handlers||(this.handlers={})},ensureHandlersByType:function(e){this.ensureHandlers(),this.handlers[e]||(this.handlers[e]=new h.Collection)},ensureBubbleParents:function(){this.bubbleParents||(this.bubbleParents={})},getTarget:function(){return this}},h.ParamPrototype={name:function(e){return void 0===e&&this.getPrivate("name")},description:function(e){var t=this.getset("description",e,"string");return void 0!==e&&t?(e=this.getPrivate("description"),this.trigger&&this.trigger("change",{property:"description",value:e}),!0):t},type:function(e){null===e&&(e=h.resolveType(null)),"bool"==e&&(e="boolean");var t=this.getset("type",e,"string",this.validateType);return void 0!==e&&t?(e=this.getPrivate("type"),this.trigger&&this.trigger("change",{property:"type",value:e}),!0):t},subtype:function(e){var t=this.getset("subtype",e,"string",this.validateSubtype);return void 0!==e&&t?(e=this.getPrivate("subtype"),this.trigger&&this.trigger("change",{property:"subtype",value:e}),!0):t},typedata:function(e){var t=this.getset("typedata",e,"string");return void 0!==e&&t?(e=this.getPrivate("typedata"),this.trigger&&this.trigger("change",{property:"typedata",value:e}),!0):t},defvalue:function(e){var t=this.getset("defvalue",e);return void 0!==e&&t?(this.trigger&&this.trigger("change",{property:"defvalue",value:e}),!0):t},validateType:function(e){return void 0!==h.ParamTypes[e]},validateSubtype:function(e){return!0},_resolveType:function(e,t,n){return t=null!=t?t:n,e=null==e?h.getType(t):h.resolveType(e)}},h.Collection=function(e){this.__type="Svidget.Collection",(this.source=e)&&(h.isArray(e)||Array.prototype.isPrototypeOf(e))&&this.push.apply(this,e)},h.Collection.prototype=new Array,h.extend(h.Collection,{any:function(e){if(null==e)return 0<this.length;for(var t=0;t<this.length;t++)if(e(this[t]))return!0;return!1},all:function(e){if(null==e)return!1;for(var t=0;t<this.length;t++)if(!e(this[t]))return!1;return!0},contains:function(e){return 0<=this.indexOf(e)},each:function(e){for(var t=0;t<this.length;t++){if(!1===e(this[t]))break}},first:function(e){if(0==this.length)return null;if(null==e)return this[0];for(var t=0;t<this.length;t++)if(e(this[t]))return this[t];return null},last:function(e){if(0==this.length)return null;if(null==e)return this[0];for(var t=this.length-1;0<=t;t--)if(e(this[t]))return this[t];return null},select:function(e){for(var t=[],n=0;n<this.length;n++)t.push(e(this[n]));return new h.Collection(t)},where:function(e){for(var t=[],n=0;n<this.length;n++)e(this[n])&&t.push(this[n]);return new h.Collection(t)},add:function(e){return!(0<=this.indexOf(e))&&(this.push(e),!0)},addRange:function(e){return!!h.isArray(e)&&(this.push.apply(this,e),!0)},insert:function(e,t){return t=parseInt(t),!(!isNaN(t)&&(t<0||t>this.length))&&(this.splice(t,0,e),!0)},remove:function(e){var t=this.indexOf(e);return!(t<0)&&(this.splice(t,1),!0)},removeAll:function(e){for(var t=!1;this.remove(e);)t=!0;return t},clear:function(){return this.splice(0,this.length),!0},removeWhere:function(e){for(var t=[],n=!1,r=0;r<this.length;r++)e(this[r])&&t.push(this[r]);for(r=0;r<t.length;r++)n=this.remove(t[r])||n;return n},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e}}),h.ObjectCollection=function(e,t){h.Collection.apply(this,[e]),this.__type="Svidget.ObjectCollection",this._ctor=h.ObjectCollection;var n=new function(){this.writable=["addedFunc","removedFunc"],this.type=t,this.addedFunc=null,this.removedFunc=null};this.setup(n)};var t=new h.Collection;return h.ObjectCollection.prototype=t,h.ObjectCollection.prototype.base_add=t.add,h.ObjectCollection.prototype.base_remove=t.remove,h.extend(h.ObjectCollection,{get:function(e){return"number"==typeof e?col.getByIndex(e):col.getByName(e)},getByIndex:function(e){if(null==e||isNaN(e))return null;var t=this[e=parseInt(e)];return null==t?null:t},getByName:function(t){return this.first(function(e){return e.name()==t})},type:function(){return this.getset("type")},add:function(){return 0==arguments.length?null:(1<=arguments.length&&(t=arguments[0]),null==(e="string"==typeof t?this.create.apply(this,arguments):t)?null:this.addObject(e)?(this.triggerAdded(e),e):null);var e,t},addObject:function(e){return!(null==e||!e instanceof this.type())&&((void 0===e.name||null==this.getByName(e.name()))&&(this.push(e),e))},create:function(){return null},remove:function(e){var t=this.getByName(e);return null!=t&&(!!this.base_remove(t)&&(this.triggerRemoved(t),!0))},wrap:function(e){var t=[e];return(null==e||!e instanceof this.type())&&(t=[]),new h.Collection(t)},onAdded:function(e){this.getset("addedFunc",e)},onRemoved:function(e){this.getset("removedFunc",e)},triggerAdded:function(e){var t=this.getset("addedFunc");t&&t(e)},triggerRemoved:function(e){var t=this.getset("removedFunc");t&&t(e)}},!0),h.extend(h.Collection,h.ObjectPrototype),h.Communicator=function(){this.__type="Svidget.Communicator",this.sameDomain=null,this._init()},h.Communicator.prototype={_init:function(){this.addMessageEvent()},addMessageEvent:function(){d.addEventListener&&d.addEventListener("message",h.wrap(this.receiveXSM,this),!1)},receiveFromParent:function(e,t){svidget.receiveFromParent(e,t)},receiveFromWidget:function(e,t,n){svidget.receiveFromWidget(e,t,n)},receiveXSM:function(e){if(null!=e){var t=e.data;null!=t&&(void 0!==t.widget?this.receiveFromWidget(t.name,t.payload,t.widget):this.receiveFromParent(t.name,t.payload))}},signalParent:function(e,t,n){this.isParentSameDomain()?this.signalParentDirect(e,t,n):this.signalParentXSM(e,t,n)},signalParentDirect:function(e,t,n){if(null!=d.parent&&d!==d.parent&&null!=d.parent.svidget&&d.parent.svidget){var r=d.parent.svidget;setTimeout(function(){r.routeFromWidget(e,t,n)},0)}},signalParentXSM:function(e,t,n){if(null!=d.parent&&null!=d.parent.postMessage){var r=this.buildSignalParentMessage(e,t,n);d.parent.postMessage(r,"*")}},buildSignalParentMessage:function(e,t,n){return{name:e,payload:t,widget:n}},isParentSameDomain:function(){return null==this.sameParentDomain&&(this.sameParentDomain=this.checkParentSameDomain()),this.sameParentDomain},checkParentSameDomain:function(){if(null==d.parent)return!1;try{d.parent.document;return!0}catch(e){return!1}},signalWidget:function(e,t,n){h.log("communicator: signalWidget {name: "+t+"}"),e.isCrossDomain()?this.signalWidgetXSM(e,t,n):this.signalWidgetDirect(e,t,n)},signalWidgetDirect:function(e,t,n){if(null!=e){var r=e.root();null!=r&&setTimeout(function(){r.receiveFromParent(t,n)},0)}},signalWidgetXSM:function(e,t,n){if(null!=e&&null!=e.window()){var r=this.buildSignalWidgetMessage(t,n);setTimeout(function(){h.log("communicator: postMessage"),e.window().postMessage(r,"*")},0)}},buildSignalWidgetMessage:function(e,t){return{name:e,payload:t}}},h.Conversion={},h.Conversion.to=function(e,t,n,r){var i=h.ParamTypes[t]||h.ParamTypes.object,a=h.ParamSubTypes[n]||h.ParamSubTypes.none;switch(i){case h.ParamTypes.string:return h.Conversion.toString(e,a,r);case h.ParamTypes.number:return h.Conversion.toNumber(e,a==h.ParamSubTypes.integer);case h.ParamTypes.bool:return h.Conversion.toBool(e);case h.ParamTypes.array:return h.Conversion.toArray(e);default:return h.Conversion.toObject(e)}},h.Conversion.toString=function(e,t,n){return null==e?null:t==h.ParamSubTypes.choice?h.Conversion.toChoiceString(e,n):h.isArray(e)||"object"==typeof e?JSON.stringify(e):e+""},h.Conversion.toChoiceString=function(e,t){if(e+="",null==t)return e;var n=t.split("|");return null==n||0==n.length?null:0<=n.indexOf(e)?e:n[0]},h.Conversion.toNumber=function(e,t){return e?!0===e?1:t?parseInt(e+""):(e=parseFloat(e),isNaN(e)&&(e=0),e):0},h.Conversion.toBool=function(e){return"false"!=(e+"").toLowerCase()&&(0!=+e&&!!e)},h.Conversion.toArray=function(e){if(null==e)return e;if(h.isArray(e))return e;if(h.Conversion.isArrayString(e)){var t=h.Conversion.parseArray(e);if(null!=t)return t}return[e]},h.Conversion.toObject=function(e){if(null==e)return e;if(h.Conversion.isJSONString(e)){var t=h.Conversion.jsonifyString(e);try{return JSON.parse(t)}catch(e){}}return e},h.Conversion.isJSONString=function(e){return!!e&&(0<(e=(e+"").trim()).length&&h.isString(e)&&"{"==e.charAt(0)&&"}"==e.charAt(e.length-1))},h.Conversion.isArrayString=function(e){return null!=e&&(0<(e=(e+"").trim()).length&&"["==e.charAt(0)&&"]"==e.charAt(e.length-1))},h.Conversion.isQuotedString=function(e){return!!e&&(0<(e=(e+"").trim()).length&&h.isString(e)&&("'"==e.charAt(0)&&"'"==e.charAt(e.length-1)||'"'==e.charAt(0)&&'"'==e.charAt(e.length-1)))},h.Conversion.parseArray=function(e){var t='{"d":'+(e=h.Conversion.jsonifyString(e))+"}";try{var n=JSON.parse(t);return n&&n.d?n.d:null}catch(e){return null}},h.Conversion.jsonifyString=function(e){if(null==e||e.indexOf("'")<0)return e;e=(e+"").trim();for(var t="",n=!1,r=null,i=!1,a=0;a<e.length;a++){var o=e[a],s=o;"'"==o||'"'==o?i?("'"==r&&"'"==o?t=t.substr(0,t.length-1):"'"==r&&'"'==o&&(s='\\\\"'),i=!1):n&&o==r?(n=!1,r=null,s='"'):n&&'"'==o?s='\\"':n||(r=o,n=!0,s='"'):"\\"==o&&(i=!0),t+=s}return t},h.DOM={get:function(e){return u.getElementById?u.getElementById(e):null},getByName:function(e,t){return this.getChildrenByName(u,e,t)},getByNameNS:function(e,t,n){if(!u.getElementsByTagNameNS)return null;var r=u.getElementsByTagNameNS(e,t);return n?new h.Collection(h.array(r)):r},getByNameSvidget:function(e,t){return this.getByNameNS(h.Namespaces.svidget,e,t)},getChildrenByName:function(e,t,n){var r=e.getElementsByTagName(t);return n?new h.Collection(h.array(r)):r},getElement:function(e){return"string"==typeof e?this.get(e):e},getItem:function(e){return this.wrap(this.get(e))},select:function(e){if(!u.querySelectorAll)return null;if(null==e)return null;var t,n=/@[^=#\s]+/g.test(e),r=new h.Collection;if(n)for(var i=e.split(","),a=0;a<i.length;a++)(t=o(i[a]))&&r.addRange(t);else(t=o(e))&&r.addRange(t);return new h.DOMQuery(r,e);function o(e){if(null==e)return null;var t,n,r=e,i=/@([^=#\s]+)$/g.exec(e);i&&(t=i[1],r=r.replace(i[0],""));try{n=u.querySelectorAll(r)}catch(e){return null}for(var a=[],o=0;o<n.length;o++){var s,c=n[o];if(t){var l=h.DOM.attr(c,t);null!=l&&(s=new h.DOMItem(l))}else s=new h.DOMItem(c);s&&a.push(s)}return new h.Collection(a)}},selectElement:function(e){if("string"==typeof e){var t=this.select(e);return null==t||0==t.length?null:t.item(0).source()}return this.isElement(e)?e:null},wrap:function(e){return new h.DOMItem(e)},transportize:function(e){return null==e?null:{name:e.localName,namespace:e.namespaceURI,value:e.value,type:1==e.nodeType?h.NodeType.element:2==e.nodeType?h.NodeType.attribute:null}},root:function(){return u.documentElement},rootItem:function(){return this.wrap(this.root())},attr:function(e,t){return e.attributes[t]},attrValue:function(e,t){var n=this.attr(e,t);return n?n.value:null},isAttrEmpty:function(e,t){var n=this.attrValue(e,t);return null!=n&&0==n.length},clone:function(e){},cloneDetached:function(e){},isDOMNode:function(e){return null==e?null:!(null==e.namespaceURI||null==e.localName||null==e.nodeType||null==e.value&&null==e.textContent||1!=e.nodeType&&2!=e.nodeType)},fromNodeType:function(e){return 1==e?"element":2==e?"attribute":3==e?"text":null},text:function(e,t){var n=this.select(e);if(void 0===t)return this.getText(n);this.setText(n,t)},getText:function(e){return e.textContent?e.textContent:e.innerHTML?e.innerHTML:null},setText:function(e,t){e.textContent?e.textContent=t+"":e.innerHTML&&(e.innerHTML=t+"")},getDocument:function(e){try{var t=e.contentDocument;null!=e.contentWindow&&e.contentWindow.document;return null!=t&&"about:blank"==t.URL?null:t}catch(e){return}},isElementDocumentReady:function(e){return null!==this.getDocument(e)},isElement:function(e){if(HTMLElement)return e instanceof HTMLElement},attach:function(e,t){},detach:function(e){},disable:function(e){e.disabled=!0},enable:function(e){e.disabled=!1},show:function(e,t){e.style.display="initial",e.style.visibility="visible"},hide:function(e,t){e.style.display="none",e.style.visibility="hidden"},on:function(e,t,n,r){r=!!r;var i=!1;return e.addEventListener?(e.addEventListener(t,n,r),i=!0):e.attachEvent&&(e.attachEvent("on"+t,n),i=!0),i},off:function(e,t,n,r){r=!!r;var i=!1;return e.removeEventListener?(e.removeEventListener(t,n,!1),i=!0):u.detachEvent&&(u.detachEvent("on"+t,n),i=!0),i}},h.DOMItem=function(e){this.__type="Svidget.DOMItem",e=e||{};var t,n=new function(){this.writable=["value"],this.type=null,this.typeCode=null,this.name=null,this.value=null,this.namespace=null,this.source=e,this.sourceDOM=h.DOM.isDOMNode(e)};this.setup(n),n.sourceDOM?(n.typeCode=1==e.nodeType?h.NodeType.element:2==e.nodeType?h.NodeType.attribute:null,n.name=e.localName,n.namespace=e.namespaceURI):(n.typeCode=e.type,n.name=e.name,n.namespace=e.namespace),n.value=e.value||e.textContent,n.type=(t=n.typeCode)==h.NodeType.element?"element":t==h.NodeType.attribute?"attribute":null,n.namespaceType=function(e){for(var t in h.Namespaces)if(e===h.Namespaces[t])return t}(n.namespace),this.cachedAttributes=null,this.cachedElements=null},h.DOMItem.prototype={typeCode:function(){return this.getset("type")},name:function(){return this.getset("name")},value:function(e){var t=this.source();if(void 0===e)return t.value||t.textContent;var n=e+"";t.value?t.value=n:t.textContent=n},namespace:function(){return this.getset("namespace")},namespaceType:function(){return this.getset("namespaceType")},hasElements:function(){if(this.isAttribute())return!1;var e=this.source();return!!(this.isAttached()||e.children&&e.children.length)&&0<e.children.length},hasAttributes:function(){if(this.isAttribute())return!1;var e=this.source();return!!(this.isAttached()||e.attributes&&e.attributes.length)&&0<e.attributes.length},isAttribute:function(){return this.type()==h.NodeType.attribute},elements:function(){if(null!=this.cachedElements&&h.isArray(this.cachedElements))return this.cachedElements;var e=this.isAttached(),t=this.source();if(!(e||t.elements&&t.elements.length))return null;var n=e?t.children:t.elements,r=new h.Collection(h.array(n));return r=r.select(function(e){return new h.DOMItem(e)}),this.cachedElements=r,this.cachedElements},attributes:function(){if(null!=this.cachedAttributes&&h.isArray(this.cachedAttributes))return this.cachedAttributes;var e=this.isAttached(),t=this.source();if(!(e||t.attributes&&t.attributes.length))return null;var n=t.attributes,r=new h.Collection(h.array(n));return r=r.select(function(e){return new h.DOMItem(e)}),this.cachedAttributes=r,this.cachedAttributes},source:function(){return this.getset("source")},isAttached:function(){return this.getset("sourceDOM")}},h.extend(h.DOMItem,h.ObjectPrototype),h.DOMQuery=function(e,t){this.__type="Svidget.DOMQuery";var n=new h.Collection(e),r=new function(){this.writable=[],this.items=n,this.selector=t};this.getPrivate=h.getPrivateAccessor(r),this.setPrivate=h.setPrivateAccessor(r),Object.defineProperty(this,"length",{enumerable:!0,configurable:!1,writable:!1,value:n.length||0})},h.DOMQuery.prototype={items:function(){return this.getset("items")},item:function(e){var t=this.items();return null==t?null:t[e]},hasItems:function(){return 0<this.length},selector:function(){return this.getset("selector")},setValue:function(t){this.items().each(function(e){e.value(t)})},toString:function(){return'[Svidget.DOMQuery { selector: "'+this.selector()+'", items: '+this.items().length+"}]"}},h.extend(h.DOMQuery,h.ObjectPrototype),h.DocType={html:0,svg:1},h.DocReadyState={loading:0,interactive:1,complete:2},h.ElementReadyState={uninitialized:0,loading:1,loaded:2,interactive:3,complete:4},h.ParamTypes={object:0,string:1,number:2,boolean:3,bool:3,array:4,function:5},h.ParamSubTypes={none:0,color:1,integer:2,regex:3,choice:4},h.NodeType={element:0,attribute:1},h.Namespaces={html:"http://www.w3.org/1999/xhtml",svidget:"http://www.svidget.org/svidget",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},h.Event=function(e,t,n,r,i,a){Object.defineProperty(this,"currentTarget",h.readOnlyProperty(r)),Object.defineProperty(this,"data",h.fixedProperty(n)),Object.defineProperty(this,"name",h.fixedProperty(e)),Object.defineProperty(this,"timeStamp",h.readOnlyProperty(+new Date)),Object.defineProperty(this,"target",h.readOnlyProperty(null==i?r:i)),Object.defineProperty(this,"type",h.readOnlyProperty(t)),Object.defineProperty(this,"value",h.readOnlyProperty(a))},h.Event.prototype={isPropagationStopped:h.returnFalse,isImmediatePropagationStopped:h.returnFalse,stopPropagation:function(){this.isPropagationStopped=h.returnTrue},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},h.EventContainer=function(e,t){this.__type="Svidget.EventContainer",h.EventPrototype.apply(this,[e]),this.target=t},h.EventContainer.prototype=new h.EventPrototype,h.extend(h.EventContainer,{getTarget:function(){return this.target}},!0),h.Root=function(e,t){this.__type="Svidget.Root";var n=this;null!=e&&(u=(d=e).document||{});var r=new function(){this.writable=["current","widgets","connected","loaded"],this.comm=new h.Communicator,this.eventContainer=new h.EventContainer(["loaded"],n),this.loaded=!1,this.current=null,this.connected=!1,this.widgets=null,this.options=t||{}};this.setup(r),this.isBrowser=!0,this.docType=null,this.setCurrent=function(e){r.current=e},this._init(),Object.defineProperty(this,"conversion",h.readOnlyProperty(h.Conversion)),Object.defineProperty(this,"Collection",h.readOnlyProperty(h.Collection)),Object.defineProperty(this,"dom",h.readOnlyProperty(h.DOM)),Object.defineProperty(this,"util",h.readOnlyProperty(h.Util)),h.root=this},h.Root.prototype={_init:function(){this._initEvents(),this._initPrototypes(),this.initInternal(),this._initReady()},_initEvents:function(){},_initPrototypes:function(){this.isWidget()?h.extend(h.Root,h.Root.WidgetPrototype,!0):h.extend(h.Root,h.Root.PagePrototype,!0)},_initReady:function(){this.isDomReady()?this._ready():this.addReadyEvents()},initInternal:function(){},_ready:function(){this.isReady=!0,this.isWidget()?this.readyWidget():this.readyPage()},getDocType:function(){if(!u.documentElement)return h.DocType.html;var e=u.documentElement.localName,t=u.documentElement.namespaceURI;return"svg"==e&&t==h.Namespaces.svg?h.DocType.svg:h.DocType.html},getOption:function(e){return this.options()[e]},isWidget:function(){return this.getOption("mode")==h.DocType.svg||(this.docType=this.getDocType(),this.docType==h.DocType.svg)},isDomReady:function(){var e=u.readyState;return!(null==e||!h.DocReadyState[e])&&h.DocReadyState[e]>=h.DocReadyState.interactive},addReadyEvents:function(){var e=h.wrap(this.readyHandler,this);h.DOM.on(u,"DOMContentLoaded",e),h.DOM.on(u,"readystatechange",e),h.DOM.on(d,"load",e)},readyHandler:function(){this.ensureReady()},ensureReady:function(){this.isReady||this._ready(),this.isReady=!0},markLoaded:function(){!0!==this.getset("loaded")&&(this.getset("loaded",!0),this.triggerLoad())},eventContainer:function(){return this.getset("eventContainer")},on:function(e,t,n,r){this.eventContainer().on(e,t,n,r)},off:function(e,t){this.eventContainer().off(e,t)},trigger:function(e,t){this.eventContainer().trigger(e,t)},loaded:function(e,t,n){this.onload(e,t,n)},onload:function(e,t,n){this.on("load",e,t,n)},offload:function(e){this.off("load",e)},offdeclaredload:function(){this.off("load",h.declaredHandlerName)},widgetloaded:function(e,t,n){this.widgetloaded(e,t,n)},onwidgetload:function(e,t,n){this.on("widgetload",e,t,n)},offwidgetload:function(e){this.off("widgetload",e)},offdeclaredwidgetload:function(){this.off("widgetload",h.declaredHandlerName)},triggerLoad:function(){this.trigger("load")},triggerWidgetLoad:function(e){this.trigger("widgetload",e)},comm:function(){return this.getset("comm")},routeFromParent:function(e,t){h.log("root: routeFromParent {name: "+e+"}"),this.comm().receiveFromParent(e,t)},routeFromWidget:function(e,t,n){h.log("root: routeFromWidget {name: "+e+"}"),this.comm().receiveFromWidget(e,t,n)},receiveFromParent:function(e,t){},receiveFromWidget:function(e,t,n){},current:function(){return null},connected:function(e){var t=this.getset("connected",e);return!(void 0===e||!t)||t},options:function(){return this.getset("options")}},h.extend(h.Root,h.ObjectPrototype),h.Util={},h.Util.queryString=function(e,t){var n={};if(!d.location)return n;for(var r,i=null==d.location.search||0<d.location.search.length?d.location.search:"",a=/\+/g,o=/([^&=]+)=?([^&]*)/g,s=function(e){return decodeURIComponent(e.replace(a," "))},c=i.substring(1);r=o.exec(c);){var l=s(r[1]),u=s(r[2]);e?void 0!==n[l]?h.isArray(n[l])?n[l].push(u):n[l]=[n[l],u]:n[l]=u:(t||void 0===n[l])&&(n[l]=u)}return n},h.Action=function(e,t,n){this.__type="Svidget.Action",t=t||{},n=n instanceof h.Widget?n:null;var r=this,i=h.Conversion,a=new function(){this.writable=["binding","bindingFunc","enabled","external","description"],this.params=new h.ActionParamCollection([],r),this.name=i.toString(e),this.description=i.toString(t.description),this.enabled=null==t.enabled||i.toBool(t.enabled),this.binding=function(e){if(null==e)return null;"function"!=typeof e&&(e=i.toString(e));return e}(t.binding),this.external=null==t.external||i.toBool(t.external),this.parent=n,this.bindingFunc=null};this.setup(a),a.bindingFunc=h.findFunction(a.binding),this.registerBubbleCallback(h.Action.eventTypes,n,n.actionBubble),this.wireCollectionAddRemoveHandlers(a.params,r.paramAdded,r.paramRemoved),function(e){if(null==e||!h.isArray(e))return;for(var t=0;t<e.length;t++){var n=e[t];null!=n.name&&r.addParam(n.name,n)}}(t.params)},h.Action.prototype={name:function(e){return void 0===e&&this.getPrivate("name")},parent:function(){return this.getPrivate("parent")},attached:function(){var e=this.parent();return null!=e&&e instanceof h.Widget},enabled:function(e){null===e&&(e=!0);var t=this.getset("enabled",e,"bool");return void 0!==e&&t?(e=this.getset("enabled"),this.trigger("change",{property:"enabled",value:e}),!0):t},description:function(e){var t=this.getset("description",e,"string");return void 0!==e&&t?(e=this.getPrivate("description"),this.trigger("change",{property:"description",value:e}),!0):t},external:function(e){null===e&&(e=!0);var t=this.getset("external",e,"bool");return void 0!==e&&t?(e=this.getPrivate("external"),this.trigger("change",{property:"external",value:e}),!0):t},binding:function(e){if(void 0!==e){"function"!=typeof e&&null!==e&&(e+="");var t=h.findFunction(e);this.getset("bindingFunc",t)}var n=this.getset("binding",e);return void 0!==e&&n?(this.trigger("change",{property:"binding",value:e}),!0):n},bindingFunc:function(){return this.getset("bindingFunc")},invoke:function(){if(!this.enabled())return!1;var e=this.invocableBindingFunc();if(!e)return!1;var t=this.buildArgumentArray(h.array(arguments)),n=e.apply(null,t);return this.trigger("invoke",{returnValue:n}),!0},invokeApply:function(e){this.invoke.apply(this,e)},invocableBindingFunc:function(){var e=this.bindingFunc();return null==e||"function"!=typeof e?null:e},buildArgumentArray:function(e){var t=[];e=null==e?[]:e;for(var n=this.params(),r=0;r<n.length;r++){var i=n[r],a=void 0;r<e.length&&(a=e[r]),void 0===a&&(a=i.defvalue()),t.push(a)}return t},toArgumentObject:function(e){for(var t={},n=this.params(),r=0;r<n.length;r++){var i=n[r],a=void 0;r<e.length&&(a=e[r]),void 0===a&&(a=i.defvalue()),t[i.name()]=a}return t},params:function(e){var t=this.getset("params");return this.select(t,e)},param:function(e){var t=this.getset("params");return this.selectFirst(t,e)},newParam:function(e,t){return new h.ActionParam(e,t,this)},addParam:function(e,t){return this.params().add(e,t,this)},removeParam:function(e){return this.params().remove(e)},removeAllParams:function(){return this.params().clear()},paramBubble:function(e,t,n){"change"==e&&this.paramChanged(n,t.value)},paramChanged:function(e,t){h.log("action: param changed: "+e.name()),this.trigger("paramchange",t,e)},paramAdded:function(e){h.log("action: param added: "+e.name()),this.trigger("paramadd",e)},paramRemoved:function(e){h.log("action: param removed: "+e.name()),this.trigger("paramremove",e.name())},onchange:function(e,t,n){return this.on("change",e,t,n)},ondeclaredchange:function(e){return this.onchange(null,h.declaredHandlerName,e)},offchange:function(e){this.off("change",e)},offdeclaredchange:function(){return this.offchange(h.declaredHandlerName)},oninvoke:function(e,t,n){return this.on("invoke",e,t,n)},ondeclaredinvoke:function(e){return this.oninvoke(null,h.declaredHandlerName,e)},offinvoke:function(e){return this.off("invoke",e)},offdeclaredinvoke:function(){return this.offinvoke(h.declaredHandlerName)},onparamadd:function(e,t,n){return this.on("paramadd",e,t,n)},ondeclaredparamadd:function(e){return this.onparamadd(null,h.declaredHandlerName,e)},offparamadd:function(e){return this.off("paramadd",e)},offdeclaredparamadd:function(){return this.offparamadd(h.declaredHandlerName)},onparamremove:function(e,t,n){return this.on("paramremove",e,t,n)},ondeclaredparamremove:function(e){return this.onparamremove(null,h.declaredHandlerName,e)},offparamremove:function(e){return this.off("paramremove",e)},offdeclaredparamremove:function(){return this.offparamremove(h.declaredHandlerName)},onparamchange:function(e,t,n){return this.on("paramchange",e,t,n)},ondeclaredparamchange:function(e){return this.onparamchange(null,h.declaredHandlerName,e)},offparamchange:function(e){return this.off("paramchange",e)},offdeclaredparamchange:function(){return this.offparamchange(h.declaredHandlerName)},toTransport:function(){return{name:this.name(),description:this.description(),external:this.external(),enabled:this.enabled(),params:this.toParamsTransport()}},toParamsTransport:function(){return this.params().select(function(e){return e.toTransport()}).toArray()},toString:function(){return'[Svidget.Action { name: "'+this.name()+'" }]'}},h.Action.eventTypes=["invoke","change","paramchange","paramadd","paramremove"],h.Action.optionProperties=["external","binding","enabled","description"],h.Action.allProxyProperties=["name","external","enabled","description"],h.Action.writableProxyProperties=[],h.extend(h.Action,h.ObjectPrototype),h.extend(h.Action,new h.EventPrototype(h.Action.eventTypes)),h.ActionCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.Action]),this.__type="Svidget.ActionCollection";this.parent=t,this._ctor=h.ActionCollection},h.ActionCollection.prototype=new h.ObjectCollection,h.extend(h.ActionCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.Action(e,t,n)}},!0),h.ActionParam=function(e,t,n){this.__type="Svidget.ActionParam",t=t||{},n=n instanceof h.Action?n:null;var r=h.Conversion,i=new function(){this.writable=["type","subtype","typedata","description","defvalue"],this.name=r.toString(e),this.type=function(e,t){e=null==e?h.getType(t):h.resolveType(e);return e}(t.type,t.defvalue),this.subtype=r.toString(t.subtype),this.typedata=r.toString(t.typedata),this.description=r.toString(t.description),this.defvalue=t.defvalue,this.parent=n};this.setup(i),this.registerBubbleCallback(h.ActionParam.eventTypes,n,n.paramBubble)},h.ActionParam.prototype={parent:function(){return this.getPrivate("parent")},attached:function(){var e=this.parent();return null!=e&&e instanceof h.Action},toTransport:function(){return{name:this.name(),type:this.type(),subtype:this.subtype(),typedata:this.typedata(),description:this.description(),defvalue:this.defvalue()}},onchange:function(e,t,n){return this.on("change",e,t,n)},ondeclaredchange:function(e){return this.onchange(null,h.declaredHandlerName,e)},offchange:function(e){this.off("change",e)},offdeclaredchange:function(){return this.offchange(h.declaredHandlerName)},toString:function(){return'[Svidget.ActionParam { name: "'+this.name()+'" }]'}},h.ActionParam.eventTypes=["change"],h.ActionParam.optionProperties=["type","subtype","typedata","description","defvalue"],h.ActionParam.allProxyProperties=["name","type","subtype","typedata","description","defvalue"],h.ActionParam.writableProxyProperties=[],h.extend(h.ActionParam,h.ObjectPrototype),h.extend(h.ActionParam,h.ParamPrototype),h.extend(h.ActionParam,new h.EventPrototype(h.ActionParam.eventTypes)),h.ActionParamCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.ActionParam]),this.__type="Svidget.ActionParamCollection";this.parent=t,this._ctor=h.ActionParamCollection},h.ActionParamCollection.prototype=new h.ObjectCollection,h.extend(h.ActionParamCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.ActionParam(e,t,n)}},!0),h.EventDesc=function(e,t,n){this.__type="Svidget.EventDesc",t=t||{},n=n instanceof h.Widget?n:null;var r=this,i=h.Conversion,a=new function(){this.writable=["description","enabled","external"],this.name=i.toString(e),this.description=i.toString(t.description),this.external=null==t.external||i.toBool(t.external),this.enabled=null==t.enabled||i.toBool(t.enabled),this.eventName="trigger",this.eventContainer=new h.EventContainer([this.eventName],r),this.parent=n};this.setup(a),a.eventContainer.registerBubbleCallback(h.EventDesc.eventTypes,n,n.eventBubble)},h.EventDesc.prototype={name:function(e){return void 0===e&&this.getPrivate("name")},attached:function(){this.parent();return null!=this.parent&&this.parent instanceof h.Widget},parent:function(){return this.getPrivate("parent")},enabled:function(e){null===e&&(e=!0);var t=this.getset("enabled",e,"bool");return void 0!==e&&t?(e=this.getset("enabled"),this.trigger("change",{property:"enabled",value:e}),!0):t},description:function(e){var t=this.getset("description",e,"string");return void 0!==e&&t?(e=this.getPrivate("description"),this.trigger("change",{property:"description",value:e}),!0):t},external:function(e){null===e&&(e=!0);var t=this.getset("external",e,"bool");return void 0!==e&&t?(e=this.getPrivate("external"),this.trigger("change",{property:"external",value:e}),!0):t},eventName:function(){return this.getPrivate("eventName")},eventContainer:function(){return this.getset("eventContainer")},on:function(e,t,n,r){h.isFunction(e)&&(r=e,e=this.eventName()),this.eventContainer().on(e,t,n,r)},ontrigger:function(e,t,n){this.eventContainer().on(this.eventName(),e,t,n)},ondeclaredtrigger:function(e){return this.ontrigger(null,h.declaredHandlerName,e)},off:function(e,t){h.isFunction(e)&&(t=e,e=this.eventName()),this.eventContainer().off(e,t)},offtrigger:function(e){this.eventContainer().off(this.eventName(),e)},offdeclaredtrigger:function(){return this.offtrigger(h.declaredHandlerName)},onchange:function(e,t,n){return this.on("change",e,t,n)},ondeclaredchange:function(e){return this.onchange(null,h.declaredHandlerName,e)},offchange:function(e){this.off("change",e)},offdeclaredchange:function(){return this.offchange(h.declaredHandlerName)},trigger:function(e,t){this.enabled()&&(void 0===t&&(t=e,e=this.eventName()),this.eventContainer().trigger(e,t))},triggerEvent:function(e){this.trigger(this.eventName(),e)},toTransport:function(){return{name:this.name(),description:this.description(),external:this.external(),enabled:this.enabled()}},toString:function(){return'[Svidget.EventDesc { name: "'+this.name()+'" }]'}},h.EventDesc.eventTypes=["trigger","change"],h.EventDesc.optionProperties=["external","enabled","description"],h.EventDesc.allProxyProperties=["name","external","enabled","description","eventContainer"],h.EventDesc.writableProxyProperties=[],h.extend(h.EventDesc,h.ObjectPrototype),h.EventDescCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.EventDesc]),this.__type="Svidget.EventDescCollection";this.parent=t,this._ctor=h.EventDescCollection},h.EventDescCollection.prototype=new h.ObjectCollection,h.extend(h.EventDescCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.EventDesc(e,t,n)}},!0),h.Param=function(i,a,o,s){this.__type="Svidget.Param",o=o||{},s=s instanceof h.Widget?s:null;var c=h.Conversion,e=new function(){var e,t,n,r;this.writable=["shortname","binding","enabled","type","subtype","value","description","defvalue","typedata","coerce","group"],this.name=c.toString(i),this.shortname=c.toString(o.shortname),this.description=c.toString(o.description),this.enabled=null==o.enabled||c.toBool(o.enabled),this.type=function(e,t,n){t=null!=t?t:n,e=null==e?h.getType(t):h.resolveType(e);return e}(o.type,a,o.defvalue),this.subtype=c.toString(o.subtype),this.typedata=c.toString(o.typedata),this.coerce=c.toBool(o.coerce),this.group=c.toString(o.group),this.value=this.coerce?(e=a,t=this.type,n=this.subtype,r=this.typedata,h.convert(e,t,n,r)):a,this.defvalue=o.defvalue,this.sanitizer=(h.isFunction(o.sanitizer)?o.sanitizer:c.toString(o.sanitizer))||null,this.parent=s,this.binding=c.toString(o.binding),this.bindingQuery=null};this.setup(e),e.bindingQuery=h.DOM.select(e.binding),e.sanitizerFunc=h.findFunction(e.sanitizer),this.valuePopulated=!1,this.registerBubbleCallback(h.Param.eventTypes,s,s.paramBubble)},h.Param.prototype={attached:function(){this.parent();return null!=this.parent&&this.parent instanceof h.Widget},parent:function(){return this.getPrivate("parent")},shortname:function(e){var t=this.getset("shortname",e,"string");return void 0!==e&&t?(e=this.getPrivate("shortname"),this.trigger("change",{property:"shortname",value:e}),!0):t},group:function(e){var t=this.getset("group",e,"string");return void 0!==e&&t?(e=this.getPrivate("group"),this.trigger("change",{property:"group",value:e}),!0):t},enabled:function(e){null===e&&(e=!0);var t=this.getset("enabled",e,"bool");return void 0!==e&&t?(e=this.getset("enabled"),this.trigger("change",{property:"enabled",value:e}),!0):t},value:function(e){if(!this.enabled()&&void 0!==e)return!1;var t=this.getset("value",e,null,this.validateValue);if(void 0===e||!t)return t;var n=e;return!0===this.getset("coerce")&&(n=this.coerceValue(n)),n=this.applySanitizer(n),this.setPrivate("value",n),this.applyBinding(n),this.trigger("valuechange",{value:n}),this.trigger("set",{value:n}),!0},serializedValue:function(){var e=this.value();return h.Conversion.toString(e)},coerce:function(e){var t=this.getset("coerce",e,"bool");return void 0!==e&&t?(e=this.getset("coerce"),this.trigger("change",{property:"coerce",value:e}),!0):t},binding:function(e){var t=this.getset("binding",e,"string");return void 0!==e&&t?(e=this.getset("binding"),this.getset("bindingQuery",h.DOM.select(e)),this.trigger("change",{property:"binding",value:e}),!0):t},bindingQuery:function(){return this.getset("bindingQuery")},sanitizer:function(e){if(void 0!==e){"function"!=typeof e&&(e+="");var t=h.findFunction(e);this.getset("sanitizerFunc",t)}var n=this.getset("sanitizer",e);return void 0!==bind&&n?(this.trigger("change",{property:"sanitizer",value:val}),!0):n},sanitizerFunc:function(){var e=this.getset("sanitizer");return h.findFunction(e)},applySanitizer:function(e){var t=this.sanitizerFunc();if(!t)return e;var n=t.call(null,this,e);return void 0===n?e:n},validateValue:function(e){return!0},coerceValue:function(e){return h.convert(e,this.type(),this.subtype(),this.typedata())},applyBinding:function(e){var t=this.bindingQuery();null!=t&&t.setValue(e)},onchange:function(e,t,n){return this.on("change",e,t,n)},ondeclaredchange:function(e){return this.onchange(null,h.declaredHandlerName,e)},offchange:function(e){this.off("change",e)},offdeclaredchange:function(){return this.offchange(h.declaredHandlerName)},onset:function(e,t,n){return this.on("set",e,t,n)},ondeclaredset:function(e){return this.onset(null,h.declaredHandlerName,e)},offset:function(e){return this.off("set",e)},offdeclaredset:function(){return this.offset(h.declaredHandlerName)},toTransport:function(){return{name:this.name(),shortname:this.shortname(),enabled:this.enabled(),type:this.type(),subtype:this.subtype(),typedata:this.typedata(),coerce:this.coerce(),defvalue:this.defvalue(),value:this.value()}},toString:function(){return'[Svidget.Param { name: "'+this.name()+'" }]'}},h.Param.eventTypes=["change","set"],h.Param.optionProperties=["type","subtype","binding","sanitizer","enabled","shortname","defvalue","typedata","coerce","group"],h.Param.allProxyProperties=["name","value","type","subtype","enabled","shortname","defvalue","typedata","coerce","group"],h.Param.writableProxyProperties=["value"],h.extend(h.Param,h.ObjectPrototype),h.extend(h.Param,h.ParamPrototype),h.extend(h.Param,new h.EventPrototype(h.Param.eventTypes)),h.ParamCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.Param]),this.__type="Svidget.ParamCollection";this.parent=t,this._ctor=h.ParamCollection},h.ParamCollection.prototype=new h.ObjectCollection,h.extend(h.ParamCollection,{create:function(e,t,n,r){return null==e?null:null!=this.getByName(e)?null:new h.Param(e,t,n,r)}},!0),h.Widget=function(){this.__type="Svidget.Widget";var e=this,t=new function(){this.writable=["id","enabled","started","connected","populatedFromPage"],this.params=new h.ParamCollection([],e),this.actions=new h.ActionCollection([],e),this.events=new h.EventDescCollection([],e),this.enabled=!0,this.connected=!1,this.started=!1,this.populatedFromPage=!1,this.id=null,this.page=null,this.parentElement=null};this.setup(t),this.wireCollectionAddRemoveHandlers(t.params,e.paramAdded,e.paramRemoved),this.wireCollectionAddRemoveHandlers(t.actions,e.actionAdded,e.actionRemoved),this.wireCollectionAddRemoveHandlers(t.events,e.eventAdded,e.eventRemoved),this._init()},h.Widget.prototype={_init:function(){},id:function(){return this.getset("id")},enabled:function(e){null===e&&(e=!0);var t=this.getset("enabled",e,"bool");return void 0!==e&&t?(e=this.getset("enabled"),this.trigger("change",{property:"enabled",value:e}),!0):t},connected:function(){return this.getset("connected")},started:function(){return this.getset("started")},populatedFromPage:function(){return this.getset("populatedFromPage")},start:function(){this.getset("started",!0)},connect:function(e){this.connected()||(this.getset("id",e),this.getset("connected",!0))},setPopulatedFromPage:function(){this.getset("populatedFromPage",!0),this.trigger("pagepopulate",this)},updateParentElement:function(e){},params:function(e){var t=this.getset("params");return this.select(t,e)},param:function(e){var t=this.getset("params");return this.selectFirst(t,e)},newParam:function(e,t,n){return new h.Param(e,t,n,this)},addParam:function(e,t,n){return this.params().add(e,t,n,this)},removeParam:function(e){return this.params().remove(e)},removeAllParams:function(){return this.params().clear()},paramAdded:function(e){h.log("widget: param added: "+e.name()),this.trigger("paramadd",e),h.root.signalParamAdded(e)},paramRemoved:function(e){h.log("widget: param removed: "+e.name()),this.trigger("paramremove",e.name()),h.root.signalParamRemoved(e.name())},paramBubble:function(e,t,n){"change"==e&&this.paramChanged(n,t.value),"valuechange"!=e&&"set"!=e||this.paramSet(n,t.value)},paramChanged:function(e,t){this.trigger("paramchange",t,e),h.root.signalParamChanged(e,t)},paramSet:function(e,t){this.trigger("paramset",t,e),this.trigger("paramvaluechange",t,e),h.root.signalParamSet(e,t)},actions:function(e){var t=this.getset("actions");return this.select(t,e)},action:function(e){var t=this.getset("actions");return this.selectFirst(t,e)},newAction:function(e,t){return new h.Action(e,t,this)},addAction:function(e,t){var n=this.actions().add(e,t,this);if(null==n)return n;if(null==t||null==t.params||!h.isArray(t.params))return n;for(var r=0;r<t.params.length;r++){var i=t.params[r];null!=i&&null!=i.name&&n.addParam(i.name,i)}},removeAction:function(e){return this.actions().remove(e)},removeAllActions:function(){return this.actions().clear()},actionAdded:function(e){h.log("widget: action added: "+e.name()),this.trigger("actionadd",e),h.root.signalActionAdded(e)},actionRemoved:function(e){h.log("widget: action removed: "+e.name()),this.trigger("actionremove",e.name()),h.root.signalActionRemoved(e.name())},actionBubble:function(e,t,n){"invoke"==e&&this.actionInvoked(n,t.value),"change"==e&&this.actionChanged(n,t.value),"paramchange"==e&&this.actionParamChanged(n,t.target,t.value),"paramadd"==e&&this.actionParamAdded(n,t.value),"paramremove"==e&&this.actionParamRemoved(n,t.value)},actionInvoked:function(e,t){this.trigger("actioninvoke",t,e),h.root.signalActionInvoked(e,t)},actionChanged:function(e,t){this.trigger("actionchange",t,e),h.root.signalActionChanged(e,t)},actionParamChanged:function(e,t,n){this.trigger("actionparamchange",n,t),h.root.signalActionParamChanged(t,e,n)},actionParamAdded:function(e,t){this.trigger("actionparamadd",t,e),h.root.signalActionParamAdded(t,e.name())},actionParamRemoved:function(e,t){this.trigger("actionparamremove",t,e),h.root.signalActionParamRemoved(t,e.name())},events:function(e){var t=this.getset("events");return this.select(t,e)},event:function(e){var t=this.getset("events");return this.selectFirst(t,e)},newEvent:function(e,t){return new h.EventDesc(e,t,this)},addEvent:function(e,t){return this.events().add(e,t,this)},removeEvent:function(e){return this.events().remove(e)},removeAllEvents:function(){return this.events().clear()},eventAdded:function(e){h.log("widget: event added: "+e.name()),this.trigger("eventadd",e),h.root.signalEventAdded(e)},eventRemoved:function(e){h.log("widget: event removed: "+e.name()),this.trigger("eventremove",e.name()),h.root.signalEventRemoved(e.name())},eventBubble:function(e,t,n){"trigger"==e&&this.eventTrigger(n,t),"change"==e&&this.eventChanged(n,t.value)},eventTrigger:function(e,t){h.log("widget: event trigger: "+e.name()),this.trigger("eventtrigger",t.value,e),h.root.signalEventTriggered(t.target,t.value)},eventChanged:function(e,t){this.trigger("eventchange",t,e),h.root.signalEventChanged(e,t)},toTransport:function(){return{id:this.id(),enabled:this.enabled(),params:this.toParamsTransport(),actions:this.toActionsTransport(),events:this.toEventsTransport()}},toParamsTransport:function(){return this.params().select(function(e){return e.toTransport()}).toArray()},toActionsTransport:function(){return this.actions().select(function(e){return e.toTransport()}).toArray()},toEventsTransport:function(){return this.events().select(function(e){return e.toTransport()}).toArray()},onchange:function(e,t,n){return this.on("change",e,t,n)},ondeclaredchange:function(e){return this.onchange(null,h.declaredHandlerName,e)},offchange:function(e){this.off("change",e)},offdeclaredchange:function(){return this.offchange(h.declaredHandlerName)},onparamadd:function(e,t,n){return this.on("paramadd",e,t,n)},ondeclaredparamadd:function(e){return this.onparamadd(null,h.declaredHandlerName,e)},offparamadd:function(e){return this.off("paramadd",e)},offdeclaredparamadd:function(){return this.offparamadd(h.declaredHandlerName)},onparamremove:function(e,t,n){return this.on("paramremove",e,t,n)},ondeclaredparamremove:function(e){return this.onparamremove(null,h.declaredHandlerName,e)},offparamremove:function(e){return this.off("paramremove",e)},offdeclaredparamremove:function(){return this.offparamremove(h.declaredHandlerName)},onparamchange:function(e,t,n){return this.on("paramchange",e,t,n)},offparamchange:function(e){return this.off("paramchange",e)},onparamset:function(e,t,n){return this.on("paramset",e,t,n)},offparamset:function(e){return this.off("paramset",e)},onactionadd:function(e,t,n){return this.on("actionadd",e,t,n)},ondeclaredactionadd:function(e){return this.onactionadd(null,h.declaredHandlerName,e)},offactionadd:function(e){return this.off("actionadd",e)},offdeclaredactionadd:function(){return this.offactionadd(h.declaredHandlerName)},onactionremove:function(e,t,n){return this.on("actionremove",e,t,n)},ondeclaredactionremove:function(e){return this.onactionremove(null,h.declaredHandlerName,e)},offactionremove:function(e){return this.off("actionremove",e)},offdeclaredactionremove:function(){return this.offactionremove(h.declaredHandlerName)},onactionchange:function(e,t,n){return this.on("actionchange",e,t,n)},offactionchange:function(e){return this.off("actionchange",e)},onactioninvoke:function(e,t,n){return this.on("actioninvoke",e,t,n)},offactioninvoke:function(e){return this.off("actioninvoke",e)},onactionparamadd:function(e,t,n){return this.on("actionparamadd",e,t,n)},offactionparamadd:function(e){return this.off("actionparamadd",e)},onactionparamremove:function(e,t,n){return this.on("actionparamremove",e,t,n)},offactionparamremove:function(e){return this.off("actionparamremove",e)},onactionparamchange:function(e,t,n){return this.on("actionparamchange",e,t,n)},offactionparamchange:function(e){return this.off("actionparamchange",e)},oneventadd:function(e,t,n){return this.on("eventadd",e,t,n)},ondeclaredeventadd:function(e){return this.oneventadd(null,h.declaredHandlerName,e)},offeventadd:function(e){return this.off("eventadd",e)},offdeclaredeventadd:function(){return this.offeventadd(h.declaredHandlerName)},oneventremove:function(e,t,n){return this.on("eventremove",e,t,n)},ondeclaredeventremove:function(e){return this.oneventremove(null,h.declaredHandlerName,e)},offeventremove:function(e){return this.off("eventremove",e)},offdeclaredeventremove:function(){return this.offeventremove(h.declaredHandlerName)},oneventchange:function(e,t,n){return this.on("eventchange",e,t,n)},offeventchange:function(e){return this.off("eventchange",e)},oneventtrigger:function(e,t,n){return this.on("eventtrigger",e,t,n)},offeventtrigger:function(e){return this.off("eventtrigger",e)},onpagepopulate:function(e,t,n){return this.on("pagepopulate",e,t,n)},offpagepopulate:function(e){return this.off("pagepopulate",e)},toString:function(){return'[Svidget.Widget { id: "'+this.id()+'" }]'}},h.Widget.eventTypes=["change","pagepopulate","paramvaluechange","paramset","paramchange","paramadd","paramremove","actioninvoke","actionchange","actionadd","actionremove","eventtrigger","eventchange","eventadd","eventremove"],h.extend(h.Widget,h.ObjectPrototype),h.extend(h.Widget,new h.EventPrototype(h.Widget.eventTypes)),h.Proxy=function(e,t,n,r,i){this.__type="Svidget.Proxy";t=t||{};var a=new h.Collection(h.isArray(n)?n:null),o=new h.Collection(h.isArray(r)?r:null),s={writable:(o=o.where(function(e){return a.contains(e)})).toArray(),propertyChangeFuncs:new h.Collection,eventContainer:new h.EventContainer(i,this),parent:e,connected:null==t.connected||!!t.connected};for(var c in this.setup(s),t)void 0===s[c]&&(s[c]=t[c]);for(var l=0;l<a.length;l++){var u=a[l]+"";0<u.length&&(this[u]=d(u))}function d(t){return function(e){return this.getsetProp(t,e)}}},h.Proxy.prototype={parent:function(){return this.getPrivate("parent")},attached:function(){return null!=this.parent()},propertyChangeFuncs:function(){return this.getPrivate("propertyChangeFuncs")},connected:function(e){return this.getPrivate("connected")},getsetProp:function(e,t){var n=this.getset(e,t);return void 0!==t&&n?(this.handlePropertyChange(e,t),!0):n},handlePropertyChange:function(e,t){},triggerPropertyChange:function(t,n){var e=this.propertyChangeFuncs(),r=this;e.each(function(e){e(r,t,n)})},notifyPropertyChange:function(e,t){null!=e&&(this.getset(e,t),this.triggerFromWidget("change",{property:e,value:t},this))},refreshProperties:function(e){for(var t in e){null!=this.getPrivate(t)&&this.setPrivate(t,e[t])}},connect:function(){this.setPrivate("connected",!0)},onPropertyChange:function(e){return this.propertyChangeFuncs().add(e),!0},offPropertyChange:function(e){return this.propertyChangeFuncs().remove(e)},eventContainer:function(){return this.getPrivate("eventContainer")},on:function(e,t,n,r){this.eventContainer().on(e,t,n,r)},off:function(e,t){this.eventContainer().off(e,t)},triggerFromWidget:function(e,t,n){this.eventContainer().trigger(e,t,n)},registerBubbleCallback:function(e,t,n){this.eventContainer().registerBubbleCallback(e,t,n)}},h.extend(h.Proxy,h.ObjectPrototype),h.ActionProxy=function(e,t,n){var r={name:e,params:new h.ActionParamProxyCollection([],this)};for(var i in t=t||{})void 0===r[i]&&(r[i]=t[i]);n&&(n=n instanceof h.WidgetReference?n:null),h.Proxy.apply(this,[n,r,h.Action.allProxyProperties,h.Action.writableProxyProperties]),this.__type="Svidget.ActionProxy",this.registerBubbleCallback(h.Action.eventTypes,n,n.actionProxyBubble),this.wireCollectionAddRemoveHandlers(r.params,this.paramAdded,this.paramRemoved)},h.ActionProxy.prototype=new h.Proxy,h.extend(h.ActionProxy,{invoke:function(){if(!this.canInvoke())return!1;var e=h.array(arguments);return svidget.signalActionInvoke(this.parent(),this,e),!0},canInvoke:function(){return this.getset("external")},invokeFromWidget:function(e){this.triggerFromWidget("invoke",{returnValue:e},this)},params:function(e){var t=this.getset("params");return this.select(t,e)},param:function(e){var t=this.getset("params");return this.selectFirst(t,e)},addParam:function(e,t){return this.params().add(e,t,this)},removeParam:function(e){return this.params().remove(e)},paramProxyBubble:function(e,t,n){"change"==e&&this.paramChanged(n,t.value)},paramChanged:function(e,t){this.triggerFromWidget("paramchange",t,e)},paramAdded:function(e){this.triggerFromWidget("paramadd",e)},paramRemoved:function(e){this.triggerFromWidget("paramremove",e.name())},onchange:function(e,t,n){return this.on("change",e,t,n)},offchange:function(e){this.off("change",e)},oninvoke:function(e,t,n){return this.on("invoke",e,t,n)},offinvoke:function(e){return this.off("invoke",e)},onparamadd:function(e,t,n){return this.on("paramadd",e,t,n)},offparamadd:function(e){return this.off("paramadd",e)},onparamchange:function(e,t,n){return this.on("paramchange",e,t,n)},offparamchange:function(e){return this.off("paramchange",e)},onparamremove:function(e,t,n){return this.on("paramremove",e,t,n)},offparamremove:function(e){return this.off("paramremove",e)},toString:function(){return'[Svidget.ActionProxy { name: "'+this.name+'" }]'}},!0),h.ActionProxyCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.ActionProxy]),this.__type="Svidget.ActionProxyCollection";this.parent=t,this._ctor=h.ActionProxyCollection},h.ActionProxyCollection.prototype=new h.ObjectCollection,h.extend(h.ActionProxyCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.ActionProxy(e,t,n)}},!0),h.ActionParamProxy=function(e,t,n){var r={name:e};for(var i in t=t||{})void 0===r[i]&&(r[i]=t[i]);n&&(n=n instanceof h.ActionProxy?n:null),h.Proxy.apply(this,[n,r,h.ActionParam.allProxyProperties,h.ActionParam.writableProxyProperties]),this.__type="Svidget.ActionParamProxy",this.registerBubbleCallback(h.ActionParam.eventTypes,n,n.paramProxyBubble)},h.ActionParamProxy.prototype=new h.Proxy,h.extend(h.ActionParamProxy,{toString:function(){return'[Svidget.ActionParamProxy { name: "'+this.name()+'" }]'}},!0),h.ActionParamProxyCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.ActionParamProxy]),this.__type="Svidget.ActionParamProxyCollection";this.parent=t,this._ctor=h.ActionParamProxyCollection},h.ActionParamProxyCollection.prototype=new h.ObjectCollection,h.extend(h.ActionParamProxyCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.ActionParamProxy(e,t,n)}},!0),h.EventDescProxy=function(e,t,n){var r={name:e,eventName:"trigger"};for(var i in t=t||{})void 0===r[i]&&(r[i]=t[i]);n&&(n=n instanceof h.WidgetReference?n:null),h.Proxy.apply(this,[n,r,h.EventDesc.allProxyProperties,h.EventDesc.writableProxyProperties]),this.__type="Svidget.EventDescProxy",this.registerBubbleCallback(h.EventDesc.eventTypes,n,n.eventProxyBubble)},h.EventDescProxy.prototype=new h.Proxy,h.extend(h.EventDescProxy,{triggerEventName:function(){return this.getPrivate("eventName")},on:function(e,t,n,r){h.isFunction(e)&&(r=e,e=this.triggerEventName()),this.eventContainer().on(e,t,n,r)},ontrigger:function(e,t,n){this.eventContainer().on(this.triggerEventName(),e,t,n)},off:function(e,t){h.isFunction(e)&&(t=e,e=this.triggerEventName()),this.eventContainer().off(e,t)},offtrigger:function(e){this.eventContainer().off(this.triggerEventName(),e)},onchange:function(e,t,n){return this.on("change",e,t,n)},offchange:function(e){this.off("change",e)},trigger:function(e){return!!this.canTrigger()&&(svidget.signalEventTrigger(this.parent(),this,e),!0)},canTrigger:function(){return this.getset("external")},triggerEventFromWidget:function(e){this.eventContainer().trigger(this.triggerEventName(),e)},toString:function(){return'[Svidget.EventDescProxy { name: "'+this.name+'" }]'}},!0),h.EventDescProxyCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.EventDescProxy]),this.__type="Svidget.EventDescProxyCollection";this.parent=t,this._ctor=h.EventDescProxyCollection},h.EventDescProxyCollection.prototype=new h.ObjectCollection,h.extend(h.EventDescProxyCollection,{create:function(e,t,n){return null==e?null:null!=this.getByName(e)?null:new h.EventDescProxy(e,t,n)}},!0),h.ParamProxy=function(e,t,n,r){var i={name:e,value:t};for(var a in n=n||{})i[a]=n[a];r&&(r=r instanceof h.WidgetReference?r:null),h.Proxy.apply(this,[r,i,h.Param.allProxyProperties,h.Param.writableProxyProperties]),this.__type="Svidget.ParamProxy",this.registerBubbleCallback(h.Param.eventTypes,r,r.paramProxyBubble)},h.ParamProxy.prototype=new h.Proxy,h.extend(h.ParamProxy,{handlePropertyChange:function(e,t){"value"==e&&(this.parent().updateParamValue(this.name(),t),svidget.signalPropertyChange(this.parent(),this,"param",e,t))},notifyValueChange:function(e){this.getset("value",e),this.triggerFromWidget("valuechange",{value:e},this),this.triggerFromWidget("set",{value:e},this)},serializedValue:function(){var e=this.value();return h.Conversion.toString(e)},onchange:function(e,t,n){return this.on("change",e,t,n)},offchange:function(e){this.off("change",e)},onset:function(e,t,n){return this.on("set",e,t,n)},offset:function(e){return this.off("set",e)},toString:function(){return'[Svidget.ParamProxy { name: "'+this.name+'" }]'}},!0),h.ParamProxyCollection=function(e,t){h.ObjectCollection.apply(this,[e,h.ParamProxy]),this.__type="Svidget.ParamProxyCollection";this.parent=t,this._ctor=h.ParamProxyCollection},h.ParamProxyCollection.prototype=new h.ObjectCollection,h.extend(h.ParamProxyCollection,{create:function(e,t,n,r){return null==e?null:null!=this.getByName(e)?null:new h.ParamProxy(e,t,n,r)}},!0),h.WidgetReference=function(e,t,n,r,i,a){this.__type="Svidget.WidgetReference";var o=this,s=new function(){this.writable=["enabled","started","populated","paramValues"],this.params=new h.ParamProxyCollection([],o),this.actions=new h.ActionProxyCollection([],o),this.events=new h.EventDescProxyCollection([],o),this.eventContainer=new h.EventContainer(h.Widget.eventTypes,o),this.paramValues=t,this.enabled=!0,this.started=!1,this.populated=!1,this.connected=!!i,this.crossdomain=!!a,this.state="declared",this.id=e,this.element=r,this.declaringElement=n,this.url=n.getAttribute("data")};this.setup(s),this.setElement=function(e){return null==s.element&&(!!h.DOM.isElement(e)&&(s.element=e,void(this.setElement=null)))},function(e){if(null==e)return;for(var t in e)this.addParamProxy(t,e[t],{connected:!1})}.call(o,t),(n.widgetReference=this).wireCollectionAddRemoveHandlers(s.params,o.paramProxyAdded,o.paramProxyRemoved),this.wireCollectionAddRemoveHandlers(s.actions,o.actionProxyAdded,o.actionProxyRemoved),this.wireCollectionAddRemoveHandlers(s.events,o.eventProxyAdded,o.eventProxyRemoved)},h.WidgetReference.prototype={id:function(){return this.getset("id")},name:function(){return this.id()},enabled:function(){return this.getset("enabled")},url:function(){return this.getset("url")},element:function(){return this.getset("element")},declaringElement:function(){return this.getset("declaringElement")},root:function(){if(this.isCrossDomain())return null;var e=this.document();return(e.parentWindow||e.defaultView).svidget},window:function(){var e=this.element();return null==e?null:e.contentWindow},document:function(){var e=this.element();return h.DOM.getDocument(e)},connected:function(e){var t=this.getset("connected",e);return!(void 0===e||!t)||t},crossdomain:function(e){var t=this.getset("crossdomain",e);return!(void 0===e||!t)||t},params:function(e){var t=this.getset("params");return this.select(t,e)},param:function(e){var t=this.getset("params");return this.selectFirst(t,e)},actions:function(e){var t=this.getset("actions");return this.select(t,e)},action:function(e){var t=this.getset("actions");return this.selectFirst(t,e)},events:function(e){var t=this.getset("events");return this.select(t,e)},event:function(e){var t=this.getset("events");return this.selectFirst(t,e)},paramValues:function(){return this.getset("paramValues")},addParamProxy:function(e,t,n){return this.params().add(e,t,n,this)},removeParamProxy:function(e){return this.params().remove(e)},refreshParamProxy:function(e,t,n){var r=this.param(e);return null==r?this.params().add(e,t,n,this):(r.refreshProperties(n),r)},updateParamValue:function(e,t){var n=this.getset("paramValues");(n=n||{})[e]=t,this.getset("paramValues",n)},paramProxyAdded:function(e){h.log("page: param proxy added: "+e.name()),this.triggerFromWidget("paramadd",e)},paramProxyRemoved:function(e){h.log("page: param proxy removed: "+e.name()),this.triggerFromWidget("paramremove",e.name())},paramProxyBubble:function(e,t,n){h.log("page: param proxy bubble: "+n.name()),"change"==e&&this.paramProxyChanged(n,t.value),"valuechange"==e&&this.paramProxyValueChanged(n,t.value)},paramProxyChanged:function(e,t){h.log("page: param proxy change: "+e.name()),this.triggerFromWidget("paramchange",t,e)},paramProxyValueChanged:function(e,t){h.log("page: param proxy value change: "+e.name()),this.triggerFromWidget("paramvaluechange",t,e)},addActionProxy:function(e,t){return this.actions().add(e,t,this)},removeActionProxy:function(e){return this.actions().remove(e)},actionProxyAdded:function(e){h.log("page: action proxy added: "+e.name()),this.triggerFromWidget("actionadd",e)},actionProxyRemoved:function(e){h.log("page: action proxy removed: "+e.name()),this.triggerFromWidget("actionremove",e.name())},actionProxyBubble:function(e,t,n){h.log("page: action proxy bubble: "+n.name()),"invoke"==e&&this.actionProxyInvoked(n,t.value),"change"==e&&this.actionProxyChanged(n,t.value),"paramchange"==e&&this.actionParamProxyChanged(n,t.target,t.value),"paramadd"==e&&this.actionParamProxyAdded(n,t.value),"paramremove"==e&&this.actionParamProxyRemoved(n,t.value)},actionProxyInvoked:function(e,t){this.triggerFromWidget("actioninvoke",t,e)},actionProxyChanged:function(e,t){this.triggerFromWidget("actionchange",t,e)},actionParamProxyAdded:function(e,t){this.triggerFromWidget("actionparamadd",t,e)},actionParamProxyRemoved:function(e,t){this.triggerFromWidget("actionparamremove",t,e)},actionParamProxyChanged:function(e,t,n){this.triggerFromWidget("actionparamchange",n,t)},addEventProxy:function(e,t){return this.events().add(e,t,this)},removeEventProxy:function(e){return this.events().remove(e)},eventProxyAdded:function(e){h.log("page: event proxy added: "+e.name()),this.triggerFromWidget("eventadd",e)},eventProxyRemoved:function(e){h.log("page: event proxy removed: "+e.name()),this.triggerFromWidget("eventremove",e.name())},eventProxyBubble:function(e,t,n){h.log("page: event proxy bubble: "+n.name()),"trigger"==e&&this.eventProxyTriggered(n,t),"change"==e&&this.eventProxyChanged(n,t.value)},eventProxyTriggered:function(e,t){h.log("page: event proxy trigger: "+e.name()),this.triggerFromWidget("eventtrigger",t.value,e)},eventProxyChanged:function(e,t){h.log("page: event proxy change: "+e.name()),this.triggerFromWidget("eventchange",t,e)},eventContainer:function(){return this.getPrivate("eventContainer")},on:function(e,t,n,r){this.eventContainer().on(e,t,n,r)},off:function(e,t){this.eventContainer().off(e,t)},triggerFromWidget:function(e,t,n){this.eventContainer().trigger(e,t,n)},hasElement:function(){return null!=this.element()},isAttached:function(){var e=this.element();return null!=e&&null!=e.parentNode},isCrossDomain:function(){return this.element()!==this.declaringElement()},started:function(){return this.getset("started")},populated:function(){return this.getset("populated")},start:function(){this.getset("started",!0)},populate:function(e){this.populated()||(this.enabled(e.enabled),this._populateParams(e.params),this._populateActions(e.actions),this._populateEvents(e.events),this.getset("populated",!0))},_populateParams:function(e){if(e&&h.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];this.refreshParamProxy(n.name,n.value,n).connect()}},_populateActions:function(e){if(e&&h.isArray(e))for(var t=0;t<e.length;t++){var n=e[t],r=this.addActionProxy(n.name,n);this._populateActionParams(n.params,r)}},_populateActionParams:function(e,t){if(e&&h.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];t.addParam(r.name,r)}},_populateEvents:function(e){if(e&&h.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];this.addEventProxy(n.name,n)}}},h.extend(h.WidgetReference,h.ObjectPrototype),h.Root.PagePrototype={initInternal:function(){this.idSeed=1,d._svidget="page",this.connected(!0),Object.defineProperty(this,"$",h.readOnlyProperty(null))},readyPage:function(){h.log("page: readyPage"),this.loadPageWidgets()},loadPageWidgets:function(){var t=this;this.findAllWidgetElements().each(function(e){t.loadPageWidget(e)})},loadPageWidget:function(e,t){if(null==e.widgetReference&&!e.svidgetLoad){var n=this.createWidgetReference(e,t);return this.addWidget(n),this.readyWidgetReference(n,e),n}},createWidgetReference:function(e,t){var n;n=void 0===t?this.parseParamElements(e):t;var r=!e.hasAttribute("data-connected")||this.isAttrEmptyOrTrue(e,"data-connected"),i=this.isAttrEmptyOrTrue(e,"data-crossdomain")||""==e.data;this.setElementPosition(e,e.getAttribute("data-x"),e.getAttribute("data-y"));var a=this.getWidgetIDForElement(e),o=this.resolveCoreWidgetElement(e,null,i),s=new h.WidgetReference(a,n,e,o,r,i);return e._widget=s},isAttrEmptyOrTrue:function(e,t){return!!h.DOM.isAttrEmpty(e,t)||h.Conversion.toBool(h.DOM.attrValue(e,t))},readyWidgetReference:function(e,t){var n=e.element()||t;this.addWidgetLoadEvents(n,e)},addWidgetLoadEvents:function(e,t){h.log("page: addWidgetLoadEvents: id = "+e.id+", tag = "+e.tagName);var n=h.wrap(this.finishPageWidget,this);t._waitingForDOM=!0,h.DOM.on(e,"load",function(){n(t)})},finishPageWidget:function(e){h.log("page: finishPageWidget: id = "+e.id()),e._waitingForDOM=!1;var t=this.ensureCoreElementResolved(e);null!=t&&t!=e.declaringElement()?this.readyWidgetReference(e,e.element()):this.ensureWidgetStarted(e)},ensureCoreElementResolved:function(e){if(e.hasElement())return null;var t=this.resolveCoreWidgetElement(e.declaringElement(),e,e.crossdomain());return null!=t?(h.log("page: CoreElementCreated: "+t.tagName+" id:"+e.id()),e.setElement(t),t):null},ensureWidgetStarted:function(e){e.hasElement()&&!e.started()&&h.DOM.isElementDocumentReady(e.element())&&this.signalStart(e,e.paramValues())},resolveCoreWidgetElement:function(e,t,n){var r=h.DOM.getDocument(e);if(null===r&&!n)return null;var i=null,a=e;return(void 0===r||n)&&(i=this.buildIFrameElement(e),e.parentNode.insertBefore(i,e),this.disableAndHide(e),a=i),a},waitForWidgets:function(){setTimeout(h.wrap(this.checkUnfinishedWidgetReferences,this),50)},checkUnfinishedWidgetReferences:function(){if(!this.allWidgetsStarted){h.log("page: checkUnfinishedWidgetReferences");var t=this;this.widgets().where(function(e){return t.needsFinishing(e)}).each(function(e){0,t.finishPageWidget(e)}),this.waitForWidgets()}},needsFinishing:function(e){return!e._waitingForDOM&&(!(e.hasElement()&&e.started()||!h.DOM.isElementDocumentReady(e.declaringElement()))||!(!e.hasElement()||!e.isCrossDomain()||e.started()||!h.DOM.isElementDocumentReady(e.element())))},areAllWidgetsStarted:function(){return this.widgets().all(function(e){return e.started()})},disableAndHide:function(e){e.data="",h.DOM.disable(e),h.DOM.hide(e)},getWidgetIDForElement:function(e){var t=e.id;return null!=t&&h.DOM.get(t)==e?t:this.newWidgetID()},newWidgetID:function(){void 0===this.idCounter&&(this.idCounter=1);for(var e=this.idCounter;;){var t="_svidget_"+e;if(e++,null==h.DOM.get(t))break}return this.idCounter=e,t},buildIFrameElement:function(e){var t=u.createElement("iframe");return h.DOM.wrap(e).attributes().each(function(e){"data"==e.name()||"data-url"==e.name()?t.setAttribute("src",e.value()):"id"==e.name()?t.setAttribute("id",e.value()+"_frame"):t.setAttribute(e.name(),e.value())}),t.frameBorder=0,t.seamless=!0,t},buildObjectElement:function(e,t){if(!u.createElement)return null;var n=u.createElement("object");for(var r in n.setAttribute("role","svidget"),n.setAttribute("data-url",e.url),!0!==e.crossdomain&&n.setAttribute("data",e.url),e.id&&n.setAttribute("id",e.id),e.width&&n.setAttribute("width",e.width),e.height&&n.setAttribute("height",e.height),void 0!==e.connected&&n.setAttribute("data-connected",e.connected),!0===e.crossdomain&&n.setAttribute("data-crossdomain",e.crossdomain),e.style&&n.setAttribute("style",e.style),e.cssclass&&n.setAttribute("class",e.cssclass),void 0!==e.allowfullscreen&&n.setAttribute("allowfullscreen",e.allowfullscreen),e.title&&n.setAttribute("title",e.title),this.setElementPosition(n,e.x,e.y),t){u.createElement("param").setAttribute("name",r)}return n},createObjectElement:function(e,t,n){var r=this.buildObjectElement(t,n);return r.svidgetLoad=!0,e.appendChild(r),r},setElementPosition:function(e,t,n){var r=null!=t?parseFloat(t):NaN,i=null!=n?parseFloat(n):NaN;if(!isNaN(r)||!isNaN(i)){var a=e.style.position;"absolute"!=a&&"fixed"!=a&&(e.style.position="absolute"),isNaN(r)||(e.style.left=r+"px"),isNaN(i)||(e.style.top=i+"px")}},populateWidgetReference:function(e,t){h.log("page: populateWidgetReference"),e.populated()||e.populate(t)},findAllWidgetElements:function(){var t=this;return h.DOM.getByName("object",!0).where(function(e){return t.containsSvidgetRole(e)})},containsSvidgetRole:function(e){var t=h.DOM.attrValue(e,"role");return/(^|,)\s*svidget\s*(,|$)/.test(t)},parseParamElements:function(e){for(var t=h.DOM.getChildrenByName(e,"param",!0),n={},r=0;r<t.length;r++){var i=t[r].getAttribute("name");null!=i&&0<i.length&&(n[i]=t[r].getAttribute("value"))}return n},getWidget:function(t){return null==t?null:this.widgets().first(function(e){return e.id()===t})},addWidget:function(e){return!this.widgets().contains(e)&&(this.widgets().add(e),!0)},load:function(e,t,n,r){var i=h.DOM.selectElement(e);if(null==i)return null;var a=null;if("string"==typeof t)a={url:t};else{if(null==t)return null;a=t}if(null!=a.url){this.allWidgetsStarted=!1;var o=this.createObjectElement(i,a,n);delete o.svidgetLoad;var s=this.loadPageWidget(o,n);return r&&"function"==typeof r&&setTimeout(function(){r(s)},0),s}},widgets:function(e){var t=this.getWidgets();return this.select(t,e)},widget:function(e){var t=this.getWidgets();return this.selectFirst(t,e)},getWidgets:function(){var e=this.getset("widgets");return null==e&&(e=new h.ObjectCollection(null,h.WidgetReference),this.getset("widgets",e)),e},triggerWidgetEvent:function(e,t,n){var r=e.event(t);null!=r&&r.triggerFromWidget(n)},receiveFromWidget:function(e,t,n){h.log("page: receiveFromWidget {name: "+e+", widgetID: "+n+"}");var r=this.getWidget(n);switch(e){case"paramadded":this.handleReceiveWidgetParamAdded(r,t);break;case"paramremoved":this.handleReceiveWidgetParamRemoved(r,t);break;case"paramchanged":this.handleReceiveWidgetParamChanged(r,t);break;case"paramset":this.handleReceiveWidgetParamSet(r,t);break;case"actionadded":this.handleReceiveWidgetActionAdded(r,t);break;case"actionremoved":this.handleReceiveWidgetActionRemoved(r,t);break;case"actionchanged":this.handleReceiveWidgetActionChanged(r,t);break;case"actioninvoked":this.handleReceiveWidgetActionInvoked(r,t);break;case"actionparamadded":this.handleReceiveWidgetActionParamAdded(r,t);break;case"actionparamremoved":this.handleReceiveWidgetActionParamRemoved(r,t);break;case"actionparamchanged":this.handleReceiveWidgetActionParamChanged(r,t);break;case"eventadded":this.handleReceiveWidgetEventAdded(r,t);break;case"eventremoved":this.handleReceiveWidgetEventRemoved(r,t);break;case"eventchanged":this.handleReceiveWidgetEventChanged(r,t);break;case"eventtriggered":this.handleReceiveWidgetEventTriggered(r,t);break;case"startack":this.handleReceiveWidgetStartAck(r,t)}},signalStart:function(e,t){h.log("page: signalStart {id: "+e.id()+", url: "+e.url()+", tag: "+e.element().tagName+"}");var n={id:e.id(),params:t,connected:e.connected()};this.comm().signalWidget(e,"start",n)},signalPropertyChange:function(e,t,n,r,i){if(e.started()&&e.connected()){h.log("page: signalPropertyChange {id: "+e.id()+", type: "+n+"}");var a={type:n,name:t.name(),propertyName:r,value:i};this.comm().signalWidget(e,"propertychange",a)}},signalActionInvoke:function(e,t,n){if(e.started()&&e.connected()){h.log("page: signalActionInvoke {id: "+e.id()+", url: "+e.url()+"}");var r={action:t.name(),args:n};this.comm().signalWidget(e,"actioninvoke",r)}},signalEventTrigger:function(e,t,n){if(e.started()&&e.connected()){h.log("page: signalEventTrigger {id: "+e.id()+"}");var r={event:t.name(),data:n};this.comm().signalWidget(e,"eventtrigger",r)}},handleReceiveWidgetInitialized:function(){h.log("page: handleReceiveWidgetInitialized")},handleReceiveWidgetLoaded:function(e,t){null!=e?this.populateWidgetReference(e,t):this.checkUnfinishedWidgetReferences()},handleReceiveWidgetStartAck:function(e,t){h.log("page: handleReceiveWidgetStartAck {widget: "+e.id()+"}"),e.started()||(e.start(),this.populateWidgetReference(e,t),this.triggerWidgetLoad(e.id()),this.areAllWidgetsStarted()&&(this.allWidgetsStarted=!0,this.markLoaded()))},handleReceiveWidgetParamAdded:function(e,t){h.log("page: handleReceiveWidgetParamAdded {param: "+t.name+"}"),e.addParamProxy(t.name,t)},handleReceiveWidgetParamRemoved:function(e,t){h.log("page: handleReceiveWidgetParamRemoved {param: "+t+"}"),e.removeParamProxy(t)},handleReceiveWidgetParamChanged:function(e,t){h.log("page: handleReceiveWidgetParamChanged {param: "+t.name+"}");var n=e.param(t.name);null!=n&&n.notifyPropertyChange(t.property,t.value)},handleReceiveWidgetParamSet:function(e,t){h.log("page: handleReceiveWidgetParamSet {param: "+t.name+"}");var n=e.param(t.name);null!=n&&n.notifyValueChange(t.value)},handleReceiveWidgetActionAdded:function(e,t){h.log("page: handleReceiveWidgetActionAdded {action: "+t.name+"}"),e.addActionProxy(t.name,t)},handleReceiveWidgetActionRemoved:function(e,t){h.log("page: handleReceiveWidgetActionRemoved {action: "+t+"}"),e.removeActionProxy(t)},handleReceiveWidgetActionChanged:function(e,t){h.log("page: handleReceiveWidgetActionChanged {action: "+t.name+"}");var n=e.action(t.name);null!=n&&n.notifyPropertyChange(t.property,t.value)},handleReceiveWidgetActionInvoked:function(e,t){h.log("page: handleReceiveWidgetActionInvoked {action: "+t.name+"}");var n=e.action(t.name);null!=n&&n.invokeFromWidget(t.returnValue)},handleReceiveWidgetActionParamAdded:function(e,t){h.log("page: handleReceiveWidgetActionParamAdded {actionparam: "+t.name+"}");var n=e.action(t.actionName);null!=n&&n.addParam(t.name,t)},handleReceiveWidgetActionParamRemoved:function(e,t){h.log("page: handleReceiveWidgetActionParamRemoved {actionparam: "+t+"}");var n=e.action(t.actionName);null!=n&&n.removeParam(t.name)},handleReceiveWidgetActionParamChanged:function(e,t){h.log("page: handleReceiveWidgetActionParamChanged {actionparam: "+t.name+"}");var n=e.action(t.actionName);if(null!=n){var r=n.param(t.name);null!=r&&r.notifyPropertyChange(t.property,t.value)}},handleReceiveWidgetEventAdded:function(e,t){h.log("page: handleReceiveWidgetEventAdded {event: "+t.name+"}"),e.addEventProxy(t.name,t)},handleReceiveWidgetEventRemoved:function(e,t){h.log("page: handleReceiveWidgetEventRemoved {event: "+t+"}"),e.removeEventProxy(t)},handleReceiveWidgetEventChanged:function(e,t){h.log("page: handleReceiveWidgetEventChanged {event: "+t.name+"}");var n=e.event(t.name);null!=n&&n.notifyPropertyChange(t.property,t.value)},handleReceiveWidgetEventTriggered:function(e,t){h.log("page: handleReceiveWidgetEventTriggered {event: "+t.name+"}");var n=e.event(t.name);null!=n&&n.triggerEventFromWidget(t.value)}},h.Root.WidgetPrototype={initInternal:function(){this.loadCurrent(),d._svidget="widget"},readyWidget:function(){h.log("widget: readyWidget"),this.startWidget(),this.markLoaded()},loadCurrent:function(){var e=new h.Widget;this.setCurrent(e),this.setCurrent=null,Object.defineProperty(this,"$",h.readOnlyProperty(e))},startWidget:function(){var e=this.current();this.parseElements(),this.connected()?this.startWidgetConnected(e):this.startWidgetStandalone(e)},startWidgetStandalone:function(e){var t=this.getParamValuesFromQueryString();this.setParamValues(e,t,!0),e.start()},startWidgetConnected:function(e){null!=this.paramValues&&(this.setParamValues(this.paramValues),this.paramValues=null,e.setPopulatedFromPage()),e.start()},parseElements:function(){var e=this.getParamsElement();this.populateParams(e);var t=this.getActionsElement();this.populateActions(t);var n=this.getEventsElement();this.populateEvents(n)},getParamsElement:function(){return this.getSvidgetElement("params")},getActionsElement:function(){return this.getSvidgetElement("actions")},getEventsElement:function(){return this.getSvidgetElement("events")},getSvidgetElement:function(e){var t=h.DOM.getByNameSvidget(e,!0);return 0==t.length?null:t[0]},populateParams:function(e){if(null!=e){var r=this,t=this.current();this.populateElementObjects(e,function(e,t){var n=r.buildParam(e,t);null!=n&&t.addParam(n)}),this.wireDeclaredHandler(t,t.ondeclaredparamadd,h.DOM.attrValue(e,"onadd")),this.wireDeclaredHandler(t,t.ondeclaredparamremove,h.DOM.attrValue(e,"onremove"))}},buildParam:function(e,t){if(!this.isValidSvidgetElement(e,"param"))return null;var n=h.DOM.attrValue(e,"name");if(null==n)return null;var r=h.DOM.attrValue(e,"value"),i=this.buildOptions(e,h.Param.optionProperties),a=new h.Param(n,r,i,t);return this.wireDeclaredChangeHandler(a,h.DOM.attrValue(e,"onchange")),this.wireDeclaredSetHandler(a,h.DOM.attrValue(e,"onset")),a},populateActions:function(e){if(null!=e){var r=this,t=this.current();this.populateElementObjects(e,function(e,t){var n=r.buildAction(e,t);null!=n&&(t.addAction(n),r.populateActionParams(e,n))}),this.wireDeclaredHandler(t,t.ondeclaredactionadd,h.DOM.attrValue(e,"onadd")),this.wireDeclaredHandler(t,t.ondeclaredactionremove,h.DOM.attrValue(e,"onremove"))}},populateActionParams:function(e,r){if(null!=e){var i=this;this.populateElementObjects(e,function(e,t){var n=i.buildActionParam(e,r);null!=n&&r.addParam(n)})}},buildAction:function(e,t){if(!this.isValidSvidgetElement(e,"action"))return null;var n=h.DOM.attrValue(e,"name");if(null==n)return null;var r=this.buildOptions(e,h.Action.optionProperties),i=new h.Action(n,r,t);return this.wireDeclaredChangeHandler(i,h.DOM.attrValue(e,"onchange")),this.wireDeclaredInvokeHandler(i,h.DOM.attrValue(e,"oninvoke")),this.wireDeclaredParamAddHandler(i,h.DOM.attrValue(e,"onparamadd")),this.wireDeclaredParamRemoveHandler(i,h.DOM.attrValue(e,"onparamremove")),this.wireDeclaredParamChangeHandler(i,h.DOM.attrValue(e,"onparamchange")),i},buildActionParam:function(e,t){if(!this.isValidSvidgetElement(e,"actionparam"))return null;var n=h.DOM.attrValue(e,"name");if(null==n)return null;var r=this.buildOptions(e,h.ActionParam.optionProperties),i=new h.ActionParam(n,r,t);return this.wireDeclaredChangeHandler(i,h.DOM.attrValue(e,"onchange")),i},populateEvents:function(e){if(null!=e){var r=this,t=this.current();this.populateElementObjects(e,function(e,t){var n=r.buildEvent(e,t);null!=n&&t.addEvent(n)}),this.wireDeclaredHandler(t,t.ondeclaredeventadd,h.DOM.attrValue(e,"onadd")),this.wireDeclaredHandler(t,t.ondeclaredeventremove,h.DOM.attrValue(e,"onremove"))}},buildEvent:function(e,t){if(!this.isValidSvidgetElement(e,"event"))return null;var n=h.DOM.attrValue(e,"name");if(null==n)return null;var r=this.buildOptions(e,h.EventDesc.optionProperties),i=new h.EventDesc(n,r,t);return this.wireDeclaredChangeHandler(i,h.DOM.attrValue(e,"onchange")),this.wireDeclaredTriggerHandler(i,h.DOM.attrValue(e,"ontrigger")),i},populateElementObjects:function(e,t){if(null!=e&&null!=e.childNodes)for(var n=this.current(),r=e.firstElementChild;null!=r;)t&&t(r,n),r=r.nextElementSibling},buildOptions:function(e,t){var n={};if(null==t||!h.isArray(t))return n;for(var r=0;r<t.length;r++){var i=t[r],a=h.DOM.attrValue(e,i);null!=a&&(n[i]=a)}return n},wireDeclaredChangeHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredchange,t)},wireDeclaredSetHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredset,t)},wireDeclaredInvokeHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredinvoke,t)},wireDeclaredTriggerHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredtrigger,t)},wireDeclaredParamAddHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredparamadd,t)},wireDeclaredParamRemoveHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredparamremove,t)},wireDeclaredParamChangeHandler:function(e,t){this.wireDeclaredHandler(e,e.ondeclaredparamchange,t)},wireDeclaredHandler:function(e,t,n){if(null!=t){var r=h.findFunction(n);null!=r&&h.isFunction(r)&&t.call(e,r)}},connectWidget:function(e,t,n){var r=this.current();r.connected()||(n?(h.log("widget: connect {id: "+e+"}"),r.connect(e),this.getset("connected",!0)):h.log("widget: standalone {id: "+e+"}"),this.paramValues=t||{},this.fixSizing())},startWidgetWithPageParams:function(){var e=this.current();e.started()&&(this.setParamValues(e,this.paramValues),e.setPopulatedFromPage())},getParamValuesFromQueryString:function(){return h.Util.queryString()},setParamValues:function(e,r,i){var t=e.params();null!=t&&t.each(function(e){var t=i&&e.shortname()||e.name(),n=r[t];void 0===n&&(n=r[e.name()]),void 0===n&&(n=e.defvalue()),void 0!==t&&e.value(n)})},isValidSvidgetElement:function(e,t){return null!=e&&e.localName==t&&e.namespaceURI==h.Namespaces.svidget},fixSizing:function(){var e=h.DOM.root();e&&e.viewBox&&e.viewBox.baseVal&&0<e.viewBox.baseVal.width&&0<e.viewBox.baseVal.height&&(e.setAttribute("width","100%"),e.setAttribute("height","100%"))},current:function(){return this.getset("current")},connected:function(){return this.getset("connected")},receiveFromParent:function(e,t){h.log("widget: receiveFromParent {name: "+e+"}"),"start"==e?this.handleReceiveParentStart(t):"actioninvoke"==e?this.handleReceiveParentActionInvoke(t):"eventtrigger"==e?this.handleReceiveParentEventTrigger(t):"propertychange"==e&&this.handleReceiveParentPropertyChange(t)},signalStartAck:function(){h.log("widget: signalStartAck {id: "+this.current().id()+"}");var e=this.current().toTransport();this.comm().signalParent("startack",e,this.current().id())},signalParamAdded:function(e){if(this.connected()){h.log("widget: signalParamAdded {id: "+this.current().id()+"}");var t=e.toTransport();this.comm().signalParent("paramadded",t,this.current().id())}},signalParamRemoved:function(e){this.connected()&&(h.log("widget: signalParamRemoved {id: "+this.current().id()+"}"),this.comm().signalParent("paramremoved",e,this.current().id()))},signalParamChanged:function(e,t){this.connected()&&(h.log("widget: signalParamChanged {id: "+this.current().id()+"}"),t.name=e.name(),this.comm().signalParent("paramchanged",t,this.current().id()))},signalParamSet:function(e,t){this.connected()&&(h.log("widget: signalParamSet {id: "+this.current().id()+"}"),t.name=e.name(),this.comm().signalParent("paramset",t,this.current().id()))},signalActionAdded:function(e){if(this.connected()){h.log("widget: signalActionAdded {id: "+this.current().id()+"}");var t=e.toTransport();this.comm().signalParent("actionadded",t,this.current().id())}},signalActionRemoved:function(e){this.connected()&&(h.log("widget: signalActionRemoved {id: "+this.current().id()+"}"),this.comm().signalParent("actionremoved",e,this.current().id()))},signalActionChanged:function(e,t){this.connected()&&(h.log("widget: signalActionChanged {id: "+this.current().id()+"}"),t.name=e.name(),this.comm().signalParent("actionchanged",t,this.current().id()))},signalActionInvoked:function(e,t){this.connected()&&(h.log("widget: signalActionInvoked {id: "+this.current().id()+"}"),t.name=e.name(),this.comm().signalParent("actioninvoked",t,this.current().id()))},signalActionParamAdded:function(e,t){if(this.connected()){h.log("widget: signalActionParamAdded {id: "+this.current().id()+"}");var n=e.toTransport();n.actionName=t,this.comm().signalParent("actionparamadded",n,this.current().id())}},signalActionParamRemoved:function(e,t){if(this.connected()){h.log("widget: signalActionParamRemoved {id: "+this.current().id()+"}");var n={name:e,actionName:t};this.comm().signalParent("actionparamremoved",n,this.current().id())}},signalActionParamChanged:function(e,t,n){this.connected()&&(h.log("widget: signalActionParamChanged {id: "+this.current().id()+"}"),n.name=e.name(),n.actionName=t.name(),this.comm().signalParent("actionparamchanged",n,this.current().id()))},signalEventAdded:function(e){if(this.connected()){h.log("widget: signalEventAdded {id: "+this.current().id()+"}");var t=e.toTransport();this.comm().signalParent("eventadded",t,this.current().id())}},signalEventRemoved:function(e){this.connected()&&(h.log("widget: signalEventRemoved {id: "+this.current().id()+"}"),this.comm().signalParent("eventremoved",e,this.current().id()))},signalEventChanged:function(e,t){this.connected()&&(h.log("widget: signalEventChanged {id: "+this.current().id()+"}"),t.name=e.name(),this.comm().signalParent("eventchanged",t,this.current().id()))},signalEventTriggered:function(e,t){if(this.connected()){h.log("widget: signalEventTriggered {id: "+this.current().id()+"}");var n={name:e.name(),value:t};this.comm().signalParent("eventtriggered",n,this.current().id())}},handleReceiveParentStart:function(e){var t=!1!==(e=e||{}).connected;this.connectWidget(e.id,e.params,t),t&&this.signalStartAck(),this.startWidgetWithPageParams()},handleReceiveParentPropertyChange:function(e){(e=e||{}).type;if("param"==e.type&&"value"==e.propertyName&&null!=e.name){var t=this.current().param(e.name);null!=t&&t.value(e.value)}},handleReceiveParentActionInvoke:function(e){var t=(e=e||{}).action,n=this.current().action(t);null!=n&&n.external()&&n.invokeApply(e.args)},handleReceiveParentEventTrigger:function(e){var t=(e=e||{}).event,n=this.current().event(t);null!=n&&n.external()&&n.trigger(e.data)}},d.document||console.warn("svidget requires a global windowy object with window.document to work correctly."),new h.Root(d,e)});